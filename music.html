<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Music Player</title>
</head>
<body>
    <!-- Hidden audio player -->
    <audio id="bgm" src="./audio/UI/Three Red Hearts - Penultimate.ogg" autoplay loop></audio>

    <script>
        const musicPage = document.getElementById("bgm");
        musicPage.volume = 0.4;

        // Listen for messages from main pages
        window.addEventListener("message", (e) => {
            if (e.data.type === "change-music") {
                const page = e.data.page;
                const puzzleNumber = e.data.puzzleNumber;

                if ((page === "home" || page === "tutorial" || page === "puzzle-select") && puzzleNumber === undefined) {
                    musicPage.src = "./audio/UI/Three Red Hearts - Penultimate.ogg";
                } else if (page === "puzzle") {
                    const tracks = [
                        "Modern Bits",
                        "Penguin Town",
                        "Puzzle Pieces",
                        "Sanctuary",
                        "Deep Blue",
                        "Box Jump",
                        "Connected"
                    ];
                    if (tracks[puzzleNumber]) {
                        musicPage.src = `./audio/UI/Three Red Hearts - ${tracks[puzzleNumber]}.ogg`;
                    }
                }

                musicPage.loop = true;
                musicPage.play().catch(err => {
                    console.log("Autoplay blocked:", err);
                });
            }
        });
    </script>
</body>
</html>
